# 요구사항 분석

## 서비스 개요
- 상품을 구매할 수 있는 E-Commerce 서비스
- 사용자는 포인트를 충전할 수 있고 충전한 포인트로 상품을 구매할 수 있다.
- 상품 구매 시 쿠폰을 사용하여 할인된 가격으로 결제할 수 있으며 쿠폰은 선착순으로 발급 받을 수 있다.
- 사용자는 최근 가장 많이 팔린 상품을 조회할 수 있다.

---

## 주요 요구사항
### 📍유저
#### 기능적 요구사항
1. 유저 정보, 인증 처리에 대한 관리 기능은 제외한다.
2. 별도 회원가입, 로그인 과정은 존재하지 않는다.
#### 비기능적 요구사항
1. 회원가입 절차가 부재하므로 유저 정보는 DB 에 직접 INSERT 하여 처리한다.

### 📍상품
#### 기능적 요구사항
1. 상품은 최소한의 정보(상품명, 가격)만 가지고 있다. 별도 카테고리나 상세 정보는 관리하지 않는다.
2. 상품을 등록하는 과정은 별도로 존재하지 않는다.
3. 유저는 상품 정보를 조회할 때 잔여 수량을 확인할 수 있다.
#### 비기능적 요구사항
1. 상품을 등록 절차가 부재하므로 상품 정보는 DB 에 직접 INSERT 하여 처리한다.
2. 상품의 잔여 수량을 조회할 땐 조회 시점의 정확한 수량을 반환해야 한다.

### 📍포인트
#### 기능적 요구사항
1. 포인트 충전은 한번에 한 유저만 할 수 있다.
2. 충전한 포인트로 상품을 구매할 수 있다.
3. 포인트 충전은 최대 한도가 존재하지 않는다.
4. 유저는 자신의 포인트 보유 현황을 조회할 수 있다.
#### 비기능적 요구사항
1. 동시에 동일한 유저에게 포인트를 충전하는 경우 모두 성공해야 한다.
2. 한 유저가 동시에 여러 구매가 이뤄지는 경우 포인트 차감에 대해

### 📍구매(결제)
#### 기능적 요구사항
1. 회원으로 등록된 유저만 상품을 구매할 수 있다.
2. 여러 상품을 한 번에 구매할 수 있다.
3. 재고가 부족한 상품 구매를 시도할 시 구매(결제)는 실패한다.
4. 결제는 유저가 보유한 포인트를 차감하는 형식으로 진행되며 보유한 포인트가 부족할 시 구매는 실패한다.
5. 환불 기능은 아직 제공하지 않는다. (추후 고려 가능)
#### 비기능적 요구사항
1. 재고 처리에 문제가 없도록 주문/결제 처리 시 동시성 이슈를 고려한다.
   1. 초기에는 트래픽이 적다고 판단하여 DB 단에서의 Optimistic Lock 을 적용하고 추후 Redis 를 이용한 분산락도 고려해본다.
2. 데이터 분석을 위해 결제 성공 시에 실시간으로 주문 정보를 데이터 플랫폼에 전송한다.

### 📍쿠폰
#### 기능적 요구사항
1. 유저는 한정된 수량의 쿠폰을 선착순으로 발급 받을 수 있다.
2. 상품 구매 시 쿠폰을 적용하면 할인된 가격으로 결제를 할 수 있다.
3. 구매건당 하나의 쿠폰만 사용할 수 있다.
4. 쿠폰은 발급일로부터 30일간 유효하다.
#### 비기능적 요구사항
1. 동시성 이슈를 고려하여 한정된 수량의 쿠폰 수에 맞게 유저에게 쿠폰이 발급이 되어야 한다.
1. 초기에는 트래픽이 적다고 판단하여 DB 단에서의 Optimistic Lock 을 적용하고 추후 Redis 또는 메시지 큐 도입을 고려해본다.

### 📍인기 판매 상품 조회
#### 기능적 요구사항
1. 최근 3일간 가장 많이 팔린 상위 5개 상품 정보를 조회하는 기능을 제공한다.
#### 비기능적 요구사항
1. 현재로서는 실시간성으로 보여진다.
2. 인기 판매 상품은 무조건 실시간성을 보장할 필요는 없으므로 추후 유저수나 해당 API 의 요청 빈도가 많아지면 캐싱 또는 Batch 작업을 고려한다.